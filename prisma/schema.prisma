// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  name      String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Client {
  id              String   @id @default(cuid())
  name            String
  type            String   // "individual" or "company"
  idCard          String?  // เลขบัตรประชาชน
  registrationNo  String?  // เลขทะเบียนบริษัท
  address         String
  phone           String?
  email           String?
  taxId           String?  // เลขประจำตัวผู้เสียภาษี
  contactPerson   String?  // ผู้ติดต่อ (สำหรับบริษัท)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  contracts       Contract[]
}

model Contract {
  id                    String   @id @default(cuid())
  contractNumber        String   // สัญญาเลขที่
  location              String   // ทำที่
  contractDate          DateTime // วันที่ทำสัญญา
  
  // ข้อมูลผู้ว่าจ้าง
  clientId              String
  client                Client   @relation(fields: [clientId], references: [id])
  
  // ข้อมูลผู้รับจ้าง
  contractorName        String   // ชื่อผู้รับจ้าง
  contractorType        String   // "individual" or "company"
  contractorIdCard      String?  // เลขบัตรผู้รับจ้าง (บุคคล)
  contractorRegistration String? // เลขทะเบียนผู้รับจ้าง (บริษัท)
  contractorAddress     String   // ที่อยู่ผู้รับจ้าง
  contractorPosition    String?  // ตำแหน่ง (สำหรับบริษัท)
  
  // รายละเอียดโครงการ
  buildingType          String   // ประเภทอาคาร
  buildingFloors        String   // จำนวนชั้น
  buildingArea          String   // พื้นที่ใช้สอย
  projectLocation       String   // ที่ตั้งโครงการ
  
  // ระยะเวลาดำเนินการ (วัน)
  floorPlanDuration     Int      @default(10)
  threeDDuration        Int      @default(15)
  constructionDuration  Int      @default(20)
  
  // ค่าตอบแทน
  totalFee              Float    // ค่าตอบแทนรวม
  paymentTerms          String   // เงื่อนไขการชำระเงิน
  
  // พยาน
  witness1Name          String?
  witness1Signature     String?
  witness2Name          String?
  witness2Signature     String?
  
  // ลายเซ็น
  clientSignature       String?
  contractorSignature   String?
  clientSignDate        DateTime?
  contractorSignDate    DateTime?
  
  status                String   @default("draft") // draft, signed, completed, cancelled
  
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt
}